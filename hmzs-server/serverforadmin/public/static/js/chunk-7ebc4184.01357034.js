(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ebc4184"],{"0481":function(e,t,r){"use strict";var s=r("23e7"),a=r("a2bf"),i=r("7b0b"),n=r("07fa"),c=r("5926"),o=r("65f0");s({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=i(this),r=n(t),s=o(t,0);return s.length=a(s,t,t,r,0,void 0===e?1:c(e)),s}})},4069:function(e,t,r){var s=r("44d2");s("flat")},"75c4":function(e,t,r){},8593:function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"e",(function(){return n})),r.d(t,"g",(function(){return c})),r.d(t,"d",(function(){return o})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"i",(function(){return f}));var s=r("b775");function a(e){return Object(s["a"])({url:"/park/sys/role",params:e})}function i(){return Object(s["a"])({url:"/park/sys/permision/all/tree"})}function n(e){return Object(s["a"])({url:"/park/sys/role/".concat(e)})}function c(e){return Object(s["a"])({url:"/park/sys/roleUser/".concat(e)})}function o(e){return Object(s["a"])({url:"/park/sys/user",params:e})}function l(e){return Object(s["a"])({url:"/park/sys/user",method:"POST",data:e})}function u(e){return Object(s["a"])({url:"/park/sys/user/".concat(e),method:"DELETE"})}function d(e){return Object(s["a"])({url:"/park/sys/role",method:"POST",data:e})}function f(e){return Object(s["a"])({url:"/park/sys/role",method:"PUT",data:e})}},a2bf:function(e,t,r){"use strict";var s=r("e8b5"),a=r("07fa"),i=r("3511"),n=r("0366"),c=function(e,t,r,o,l,u,d,f){var m,v,p=l,b=0,h=!!d&&n(d,f);while(b<o)b in r&&(m=h?h(r[b],b,t):r[b],u>0&&s(m)?(v=a(m),p=c(e,t,m,v,p,u-1)-1):(i(p+1),e[p]=m),p++),b++;return p};e.exports=c},b031:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-role"},[r("header",{staticClass:"add-header"},[r("div",{staticClass:"left"},[r("span",{staticClass:"arrow",on:{click:function(t){return e.$router.back()}}},[r("i",{staticClass:"el-icon-arrow-left"}),e._v("返回")]),r("span",[e._v("|")]),r("span",[e._v("添加角色")])]),r("div",{staticClass:"right"},[e._v(" 黑马程序员 ")])]),r("main",{staticClass:"add-main"},[r("div",{staticClass:"step-container"},[r("el-steps",{attrs:{direction:"vertical",active:e.currentActive}},[r("el-step",{attrs:{title:"角色信息"}}),r("el-step",{attrs:{title:"权限信息"}}),r("el-step",{attrs:{title:"检查并完成"}})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.currentActive,expression:"currentActive === 1"}],staticClass:"form-container"},[r("div",{staticClass:"title"},[e._v("角色信息")]),r("div",{staticClass:"form"},[r("el-form",{ref:"infoForm",staticClass:"form-box",attrs:{model:e.roleForm,rules:e.roleRules}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述"}},[r("el-input",{model:{value:e.roleForm.remark,callback:function(t){e.$set(e.roleForm,"remark",t)},expression:"roleForm.remark"}})],1)],1)],1)]),r("div",{directives:[{name:"show",rawName:"v-show",value:2===e.currentActive,expression:"currentActive === 2"}],staticClass:"form-container"},[r("div",{staticClass:"title"},[e._v("权限配置")]),r("div",{staticClass:"form"},[r("div",{staticClass:"tree-wrapper"},e._l(e.treeList,(function(t){return r("div",{key:t.id,staticClass:"tree-item"},[r("div",{staticClass:"tree-title"},[e._v(e._s(t.title))]),r("el-tree",{ref:"tree",refInFor:!0,attrs:{data:t.children,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"","check-strictly":"",props:{label:"title"}}})],1)})),0)])]),r("div",{directives:[{name:"show",rawName:"v-show",value:3===e.currentActive,expression:"currentActive === 3"}],staticClass:"form-container"},[r("div",{staticClass:"title"},[e._v("检查并完成")]),r("div",{staticClass:"form"},[r("div",{staticClass:"info"},[r("div",{staticClass:"form-item"},[e._v("角色名称："+e._s(e.roleForm.roleName))]),r("div",{staticClass:"form-item"},[e._v("角色描述："+e._s(e.roleForm.remark))]),r("div",{staticClass:"form-item"},[e._v("角色权限：")]),r("div",{staticClass:"tree-wrapper"},e._l(e.disableTreeList,(function(t){return r("div",{key:t.id,staticClass:"tree-item"},[r("div",{staticClass:"tree-title"},[e._v(e._s(t.title))]),r("el-tree",{ref:"diabledTree",refInFor:!0,attrs:{data:t.children,"show-checkbox":"","default-expand-all":"","check-strictly":"","node-key":"id","highlight-current":!1,props:{label:"title",disabled:function(){return!0}}}})],1)})),0)])])])]),r("footer",{staticClass:"add-footer"},[r("div",{staticClass:"btn-container"},[e.currentActive>1?r("el-button",{on:{click:e.prev}},[e._v("上一步")]):e._e(),3!==e.currentActive?r("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")]):e._e(),3===e.currentActive?r("el-button",{attrs:{type:"primary"},on:{click:e.confirmAdd}},[e._v("确认添加")]):e._e()],1)])])},a=[],i=r("5530"),n=r("c7eb"),c=r("1da1"),o=(r("d3b7"),r("159b"),r("b64b"),r("e9c4"),r("14d9"),r("0481"),r("4069"),r("8593")),l={data:function(){return{currentActive:1,roleForm:{roleName:"",remark:""},roleRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},treeList:[],disableTreeList:[],permsList:[]}},computed:{roleId:function(){return this.$route.query.roleId}},mounted:function(){var e=this;return Object(c["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTreeList();case 2:e.roleId&&e.getDetail();case 3:case"end":return t.stop()}}),t)})))()},methods:{getDetail:function(){var e=this;return Object(c["a"])(Object(n["a"])().mark((function t(){var r,s,a,i,c;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["e"])(e.roleId);case 2:r=t.sent,s=r.data,a=s.perms,i=s.roleName,c=s.remark,e.roleForm.roleName=i,e.roleForm.remark=c,e.$refs.tree.forEach((function(e,t){e.setCheckedKeys(a[t])}));case 7:case"end":return t.stop()}}),t)})))()},confirmAdd:function(){var e=this;return Object(c["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.roleId){t.next=5;break}return t.next=3,Object(o["i"])(Object(i["a"])(Object(i["a"])({roleId:e.roleId},e.roleForm),{},{perms:e.permsList}));case 3:t.next=7;break;case 5:return t.next=7,Object(o["a"])(Object(i["a"])(Object(i["a"])({},e.roleForm),{},{perms:e.permsList}));case 7:e.$router.back();case 8:case"end":return t.stop()}}),t)})))()},getTreeList:function(){var e=this;return Object(c["a"])(Object(n["a"])().mark((function t(){var r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["h"])();case 2:r=t.sent,e.treeList=r.data,e.disableTreeList=JSON.parse(JSON.stringify(r.data));case 5:case"end":return t.stop()}}),t)})))()},prev:function(){1!==this.currentActive&&this.currentActive--},next:function(){var e=this;if(3!==this.currentActive)if(1===this.currentActive)this.$refs.infoForm.validate((function(t){t&&e.currentActive++}));else if(2===this.currentActive){if(this.permsList=[],this.$refs.tree.forEach((function(t){var r=t.getCheckedKeys();console.log(r),e.permsList.push(r)})),0===this.permsList.flat().length)return this.$message({type:"warning",message:"请至少选择一项"});this.currentActive++,this.$refs.diabledTree.forEach((function(t,r){t.setCheckedKeys(e.permsList[r])}))}}}},u=l,d=(r("e01b"),r("2877")),f=Object(d["a"])(u,s,a,!1,null,"114d4bdd",null);t["default"]=f.exports},e01b:function(e,t,r){"use strict";r("75c4")}}]);